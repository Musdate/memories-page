import{a as B}from"./chunk-WKARWWOO.js";import{b as A,c as g,d as D,e as U,g as V,j as T,k as q,l as L,m as I,o as R,p as $}from"./chunk-6424UODT.js";import{b as G}from"./chunk-ZIYSPSZR.js";import"./chunk-POUALIHI.js";import{$a as N,Ba as S,Hb as w,Jb as E,Pa as x,Qa as y,R as d,Ra as F,Sa as k,Ta as M,Ua as u,Va as n,W as _,Wa as r,X as C,Xa as c,ab as f,bb as b,ea as p,gb as o,hb as O,kb as P,ra as s}from"./chunk-WIJM5ZBD.js";import{a as m,b as v}from"./chunk-C6Q5SG76.js";var J=i=>({"error-input":i});function j(i,e){if(i&1&&(n(0,"div",12)(1,"div",4)(2,"label",13),o(3),r(),c(4,"input",14),r()()),i&2){let t,a=e.$implicit,l=e.$index;u("formGroupName",l),s(3),O(" ",(t=a.get("name"))==null?null:t.value," ")}}function z(i,e){if(i&1&&(n(0,"fieldset")(1,"div",11)(2,"div",3),o(3," Paseos "),r(),k(4,j,5,2,"div",12,F),r()()),i&2){let t=b();s(4),M(t.banks.controls)}}function H(i,e){if(i&1){let t=N();n(0,"div",15),f("click",function(){_(t);let l=b();return C(l.onAddBank())}),o(1," Agregar cuentas bancarias "),r()}}var h=class i{fb=d(R);authService=d(B);alertService=d(G);isLoading=p(!1);errorNameField=p(!1);originalValues;userForm=this.fb.group({name:[this.authService.user().name,[g.required]],email:[{value:this.authService.user().email,disabled:!0},[g.required]],banks:this.fb.array([])});ngOnInit(){this.loadBanks(),this.originalValues=m({},this.userForm.value)}get banks(){return this.userForm.get("banks")}loadBanks(){(this.authService.user()?.banks??[]).forEach(e=>{this.banks.push(this.createBanksForm(e))})}createBanksForm(e){return this.fb.group({name:[e.name,[g.required]],number:[e.number]})}onSaveSettings(){if(JSON.stringify(this.userForm.value)!==JSON.stringify(this.originalValues))if(this.userForm.valid){this.isLoading.set(!0);let e=v(m({},this.userForm.value),{_id:this.authService.user()?._id});this.authService.update(e).subscribe({next:()=>{this.originalValues=m({},this.userForm.value),this.alertService.showSuccess({text:"Guardado Exitoso!!",timer:2e3})},error:t=>{this.alertService.showError({text:t.error.message||"Error al guardar.",timer:2e3}),this.isLoading.set(!1)},complete:()=>{this.isLoading.set(!1)}})}else this.errorNameField.set(!0),this.alertService.showError({text:"Username es requerido",timer:2e3})}onAddBank(){this.banks.push(this.createBanksForm({name:"Bancolombia",number:""})),this.banks.push(this.createBanksForm({name:"Nequi",number:""}))}hasErrors(e){return!!(this.userForm.get(e)?.invalid&&this.userForm.get(e)?.touched)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=S({type:i,selectors:[["app-user-settings"]],decls:17,vars:5,consts:[[1,"settings-title","container"],[3,"ngSubmit","formGroup"],[1,"input-section-container"],[1,"title"],[1,"input-section"],["for","settings-name"],["id","settings-name","type","text","formControlName","name","placeholder","Nombre del usuario",3,"ngClass"],["for","settings-email"],["id","settings-email","type","text","formControlName","email","placeholder","Correo electronico"],[1,"no-banks-message"],["type","submit",1,"primary-btn"],["formArrayName","banks",1,"input-section-container"],[3,"formGroupName"],["for","settings-bname"],["id","settings-bname","formControlName","number","type","text","placeholder","Numero de cuenta"],[1,"no-banks-message",3,"click"]],template:function(t,a){t&1&&(n(0,"div",0)(1,"form",1),f("ngSubmit",function(){return a.onSaveSettings()}),n(2,"fieldset",2)(3,"div",3),o(4," Cuenta "),r(),n(5,"div",4)(6,"label",5),o(7," Username "),r(),c(8,"input",6),r(),n(9,"div",4)(10,"label",7),o(11," Email "),r(),c(12,"input",8),r()(),x(13,z,6,0,"fieldset")(14,H,2,0,"div",9),n(15,"button",10),o(16," Guardar "),r()()()),t&2&&(s(),u("formGroup",a.userForm),s(7),u("ngClass",P(3,J,a.hasErrors("name"))),s(5),y(a.banks.length>0?13:14))},dependencies:[$,V,A,D,U,T,I,q,L,E,w],styles:['@font-face{font-family:Roboto;src:url(/assets/fonts/Roboto.woff2) format("woff2"),url(/assets/fonts/Roboto.woff) format("woff");font-weight:400;font-style:normal;font-display:swap}.settings-title[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;color:#404040;width:30rem;margin-top:3rem}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;width:100%}fieldset[_ngcontent-%COMP%]{background-color:#fff;border-radius:1rem;border:unset;padding:0rem 0rem 2rem;box-shadow:0 .5rem 1rem #0000001a}fieldset[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;flex-direction:column}fieldset[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:4.5rem;padding:0rem 1.5rem;border-radius:1rem;border:.1rem solid #D9D9D9;background:#fff;color:#404040;caret-color:silver}fieldset[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:silver}fieldset[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none}fieldset[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%]{color:#000;width:100%;text-align:center;font-weight:700;padding:1rem;border-radius:1rem}.input-section-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.title[_ngcontent-%COMP%]{text-align:center;font-size:2rem;font-weight:500;border-bottom:1px solid #C0C0C0;color:#404040;padding:2rem 0rem 1rem;margin:0rem 0rem 1rem}.input-section[_ngcontent-%COMP%]{padding:0rem 2rem}.input-section[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{padding:0rem 1.5rem}.input-section[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled{background-color:#d9d9d9}.no-banks-message[_ngcontent-%COMP%]{text-align:end;color:#6cc2e6;cursor:pointer}']})};export{h as default};
