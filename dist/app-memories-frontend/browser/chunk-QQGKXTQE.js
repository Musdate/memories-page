import{b as R,y as G}from"./chunk-NYIXKUAA.js";import{a as V}from"./chunk-IZGYBH2K.js";import{j as $,l as j,m as H}from"./chunk-FLQC55CT.js";import{e as O,i as D}from"./chunk-3SD2HFRY.js";import{b as N,d as I,f as W,i as B,p as F}from"./chunk-6424UODT.js";import{a as z,b as T}from"./chunk-ZIYSPSZR.js";import"./chunk-POUALIHI.js";import{$a as E,Ba as S,Pa as v,Qa as w,R as h,Sa as M,Ta as L,Ua as b,Va as a,W as x,Wa as n,X as y,Xa as d,Y as p,Z as g,ab as u,bb as P,ea as f,gb as l,hb as k,kb as A,ra as c,y as C}from"./chunk-WIJM5ZBD.js";import{e as q}from"./chunk-C6Q5SG76.js";var o=q(z());var Y=i=>["/landing/walk-info",i],J=(i,e)=>e._id;function K(i,e){i&1&&d(0,"app-loading")}function Q(i,e){i&1&&(a(0,"div",8)(1,"div"),l(2," Aun no tienes mascotas para pasear "),n(),a(3,"div"),l(4," agrega una !! "),n()())}function U(i,e){if(i&1){let t=E();a(0,"div",9)(1,"a",10)(2,"div",11),l(3),n(),a(4,"div",12),l(5),n()(),a(6,"div",13),u("click",function(){let m=x(t).$implicit,s=P(2);return y(s.onNewActivity(m))}),p(),d(7,"svg",14),n()()}if(i&2){let t=e.$implicit;c(),b("routerLink",A(3,Y,t._id)),c(2),k(" ",t.name," "),c(2),k(" ",t.comment," ")}}function X(i,e){if(i&1&&M(0,U,8,5,"div",9,J),i&2){let t=P();L(t.filteredPets())}}var _=class i{walksService=h(R);alertService=h(T);allPets=[];archivedPets=[];filteredPets=f([]);isLoading=f(!1);isLoadingPets=f(!1);searchControl=new W("");ngOnInit(){this.loadPets(),this.searchControl.valueChanges.pipe(C(300)).subscribe(e=>{this.filteredPets.set(this.onFilterPets(e??""))})}loadPets(){this.isLoadingPets.set(!0),this.walksService.findAllPets().subscribe({next:e=>{this.allPets=e.reverse(),this.filteredPets.set(this.allPets)},error:e=>{this.alertService.showError({text:e.error.message||"Error.",timer:2e3}),this.isLoadingPets.set(!1)},complete:()=>{this.isLoadingPets.set(!1)}})}onSavePet(e){this.isLoading.set(!0),this.walksService.onSavePet(e).subscribe({next:()=>{this.alertService.showSuccess({text:"Guardado Exitoso!!",timer:2e3})},error:t=>{this.alertService.showError({text:t.error.message||"Error.",timer:2e3}),this.isLoading.set(!1)},complete:()=>{this.loadPets(),this.isLoading.set(!1)}})}async addPet(){let{value:e}=await o.default.fire({title:"Agregar Mascota",html:`
        <label for="swal-petName"> Nombre </label>
        <input id="swal-petName" class="modal-input" type="text" placeholder="Nombre Mascota" autocomplete="off">
        <label for="swal-petComment"> Comentario </label>
        <input id="swal-petComment" class="modal-input" type="text" placeholder="Comentario" autocomplete="off">
      `,focusConfirm:!1,confirmButtonText:"Guardar",customClass:{confirmButton:"primary-btn",cancelButton:"primary-btn"},preConfirm:()=>({name:document.getElementById("swal-petName").value,comment:document.getElementById("swal-petComment").value})});e&&this.onSavePet(e)}async toggleArchivePets(){o.default.fire({title:"Mascotas Archivadas",didOpen:()=>o.default.showLoading()}).then(e=>{e.isConfirmed&&e.value.length>0&&(this.isLoading.set(!0),this.walksService.toggleArchivePet(e.value).subscribe({next:()=>{this.alertService.showSuccess({text:"Mascotas desarchivadas.",timer:2e3})},error:t=>{this.alertService.showError({text:t.error.message||"Error.",timer:2e3}),this.isLoading.set(!1)},complete:()=>{this.isLoading.set(!1),this.loadPets()}}))}),this.walksService.findArchivedPets().subscribe({next:e=>{this.archivedPets=e,o.default.hideLoading(),e.length===0?o.default.update({html:'<div class="no-archived-text"> No hay mascotas archivadas. </div>',showConfirmButton:!0}):o.default.update({html:`
              <div class="archived-pets-container">
                ${e.map(t=>`
                  <label>
                    <input type="checkbox" class="archived-checkbox" value="${t._id}">
                    ${t.name}
                  </label>
                `).join("")}
              </div>
            `,showConfirmButton:!0,confirmButtonText:"Desarchivar",preConfirm:()=>Array.from(document.querySelectorAll(".archived-checkbox:checked")).map(r=>r.value)})},error:()=>{o.default.hideLoading(),o.default.update({html:'<div style="color:#842029;"> Error al cargar mascotas archivadas. </div>',showConfirmButton:!0})}})}onFilterPets(e){return this.allPets.length<=100?e?this.allPets.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())):this.allPets:(this.isLoadingPets.set(!0),this.walksService.findPetsByName(e).subscribe({next:t=>{this.filteredPets.set(t)},error:t=>{this.alertService.showError({text:t.error.message||"Error.",timer:2e3}),this.isLoadingPets.set(!1)},complete:()=>{this.isLoadingPets.set(!1)}}),this.filteredPets())}onNewActivity(e){let t=G(new Date,"dd-MM-yyyy"),r=e.activity.some(s=>s.date===t),m={date:t,activityType:"Paseo",paid:!1,note:""};if(r){this.alertService.showError({text:`Ya has paseado a ${e.name} hoy.`,timer:2e3});return}this.isLoading.set(!0),this.walksService.addPetActivity(e._id,m).subscribe({next:s=>{e.activity=s.activity,this.alertService.showSuccess({text:`Has paseado a ${e.name}!!`,timer:2e3})},error:s=>{this.alertService.showError({text:s.error.message||"Error.",timer:2e3}),this.isLoading.set(!1)},complete:()=>{this.isLoading.set(!1)}})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=S({type:i,selectors:[["app-walks"]],decls:15,vars:3,consts:[[1,"walks-container"],[1,"walks-buttons-container"],[1,"btn","add-pet-btn",3,"click"],["plus-icon",""],[1,"btn","archived-pet-btn",3,"click"],["archive-icon",""],["type","text","placeholder","Buscar mascota...",1,"walks-search-input",3,"formControl"],[1,"walks-card-container"],[1,"no-pets-container"],[1,"walk-card"],[3,"routerLink"],[1,"walk-card-name"],[1,"walk-card-comment"],[1,"walk-card-icon-container","primary-btn-color",3,"click"],["walks-icon",""]],template:function(t,r){t&1&&(v(0,K,1,0,"app-loading"),a(1,"div",0)(2,"div",1)(3,"button",2),u("click",function(){return r.addPet()}),a(4,"div"),l(5," Agregar Mascota "),n(),p(),d(6,"svg",3),n(),g(),a(7,"button",4),u("click",function(){return r.toggleArchivePets()}),a(8,"div"),l(9," Mascotas Archivadas "),n(),p(),d(10,"svg",5),n(),g(),d(11,"input",6),n(),a(12,"div",7),v(13,Q,5,0,"div",8)(14,X,2,0),n()()),t&2&&(w(r.isLoading()||r.isLoadingPets()?0:-1),c(11),b("formControl",r.searchControl),c(2),w(r.allPets.length===0?13:14))},dependencies:[V,D,O,$,H,F,N,I,B,j],styles:['@font-face{font-family:Roboto;src:url(/assets/fonts/Roboto.woff2) format("woff2"),url(/assets/fonts/Roboto.woff) format("woff");font-weight:400;font-style:normal;font-display:swap}.walks-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;gap:3rem;margin:3rem 0rem}.walks-buttons-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:1rem;width:100%;flex-wrap:wrap}.walks-search-input[_ngcontent-%COMP%]{width:22rem;height:5rem;padding:0px 1rem;border-radius:1rem;border:.1rem solid #D9D9D9;background:#fff;color:#404040;caret-color:silver}.walks-search-input[_ngcontent-%COMP%]::placeholder{color:silver}.walks-search-input[_ngcontent-%COMP%]:focus{outline:none}.walks-card-container[_ngcontent-%COMP%]{display:grid;gap:1rem;grid-template-columns:repeat(auto-fit,minmax(35rem,1fr));width:100%;padding:0rem 1rem}@media (min-width: 768px){.walks-card-container[_ngcontent-%COMP%]{gap:2rem;padding:0rem 2rem}}.no-pets-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;padding:5rem 0rem}.walk-card[_ngcontent-%COMP%]{display:flex;background-color:#fff;color:#000;border-radius:.7rem;height:10rem;box-shadow:0 5px 10px #0000001a;cursor:pointer}.walk-card[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:column;justify-content:center;align-items:center;height:100%}.walk-card-icon-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%;width:fit-content;padding:1rem;border-radius:0rem .7rem .7rem 0rem;background-color:#eaf6fb}.walk-card-icon-container[_ngcontent-%COMP%]:hover{background-color:#6cc2e6;color:#fff}.walk-card-name[_ngcontent-%COMP%]{font-size:2rem;font-weight:500;margin:1rem;text-align:center}.walk-card-comment[_ngcontent-%COMP%]{color:gray;padding:0px 1rem;text-align:center}.add-pet-btn[_ngcontent-%COMP%]{min-width:20rem}.add-pet-btn[_ngcontent-%COMP%]:hover{color:#3cb371}.archived-pet-btn[_ngcontent-%COMP%]{min-width:20rem}.archived-pet-btn[_ngcontent-%COMP%]:hover{color:#6cc2e6}.price-btn[_ngcontent-%COMP%]:hover{color:#ffc84b}']})};export{_ as default};
